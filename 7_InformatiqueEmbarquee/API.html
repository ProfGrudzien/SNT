<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8"/>
        <link rel="stylesheet" href="../style.css"/>
    </head>
    <body>
        <div class="main">
            <h1>Interface de programmation</h1>
            <h2>Définition</h2>
            <p>
                Une API (application programming interface ou « interface de programmation d’application ») est une interface logicielle qui permet de « connecter » un logiciel ou un service à un autre logiciel ou service afin d’échanger des données et des fonctionnalités.
            </p>
            <p>
                Les API web permettent d'accéder à des données en utilisant de simples requêtes HTTP. C'est ce que nous allons étudier ici grâce au logiciel Insomnia REST.
            </p>
            <h2>API ouverte en accès libre</h2>
            <p>
                Ces interfaces de programmation sont directement utilisable et ne demande pas d'inscription préalable ou d’authentification.
                Le site <a href="https://api.gouv.fr/">https://api.gouv.fr/</a> liste les API proposé par l'administration publiques dont certaines sont en accès libre. C'est le cas par exemple de l'interface de programmation permettant d'auto-compléter une adresse en France.
            </p>
            <div class="exercice">
                Avec le logiciel Insomnia REST :
                <ol>
                    <li>Dans la barre d'URL, après le nom de méthode <mark class="code">GET</mark> entrer l'adresse <mark class="code">https://api-adresse.data.gouv.fr/search?q=Fabre%20Cavaillon</mark>.</li>
                    <li>Après avoir cliqué sur <mark class="code">Send</mark>, combien de résultats obtient-on ?</li>
                </ol>
            </div>
            <p>
                On peut trouver d'autres sources d'interface de programmation sur internet.
                Par exemple l'API <a href="http://worldtimeapi.org">http://worldtimeapi.org</a> permet de cherche des fuseaux horaires.
            </p>
            <div class="exercice">
                Avec le logiciel Insomnia REST :
                <ol>
                    <li>Dans la barre d'URL, après le nom de méthode <mark class="code">GET</mark> entrer l'adresse <mark class="code">http://worldtimeapi.org/api/timezone/Europe/Madrid</mark>. Quelle heure est-il à Madrid ?</li>
                    <li>En entrant la bonne adresse URL, déterminer l'heure à Lima (Pérou) ?</li>
                    <li>Cette API permet de donner l'heure du fuseau horaire lié à son adresse IP. En utilisant l'url <mark class="code">http://worldtimeapi.org/api/ip</mark>, quelle heure obtient-on ?</li>
                    <li>Cette API permet aussi de donner l'heure du fuseau horaire associé à une adresse IP donnée. Qu'obtient-on en utilisant l'url <mark class="code">http://worldtimeapi.org/api/ip/8.8.8.8</mark></li>
                </ol>
            </div>
            <h2>API avec authentification</h2>
            <p>
                Certaines API demandent une authentification pour pouvoir être utilisée.
                Parfois il s'agît simplement de se protéger contre des personnes mal intentionné qui pourrait surchargé le serveur en envoyant des milliers de requêtes par secondes (utilisation d'une clé d'API par exemple), parfois il s'agît de partager des données uniquement avec des personnes habilités (service des impôts par exemple).
            </p>
            <div class="exercice">
                Dans cet exercice, nous allons utilisé un serveur local fournissant une API simple avec authentification.<br/>
                Le rôle de cette API est de garder des secrets.
                <ol>
                    <li>Télécharger le fichier <a href="serveurAPI.zip">serveurAPI.zip</a></li>
                    <li>Etraire le contenu de ce fichier dans vos documents</li>
                    <li>Executer le fichier <mark class="code">serveurAPI.py</mark> et laisser la fenêtre ouverte.<br/>
                        L'API est prête à être utilisée.</li>
                    <li>Avec Insomnia REST, envoyer la requête <mark class="code">localhost:3000/test</mark>.<br/>
                        Quelle est la réponse obtenue ?</li>
                    <li>Dans l'onglet <mark class="code">Auth</mark>, choisir <mark class="code">Basic Auth</mark> et saisir <mark class="code">admin</mark> comme nom d'utilisateur et <mark class="code">vivaSNT</mark> comme mot de passe.<br/>
                        Quelle est la réponse obtenue ?</li>
                    <li>En étant authentifié comme <mark class="code">admin</mark>, choisissez la méthode <mark class="code">PUT</mark> et l'url <mark class="code">localhost:3000/creerUtilisateur</mark>.
                        Dans l'onglet <mark class="code">Body</mark> choisir <mark class="code">JSON</mark> et coller le texte <mark class="code">{"user":"Ismael", "password":"dauphin83"}</mark>.<br/>
                        Vous venez de créer un nouvel utilisateur</li>
                    <li>S'authentifier en tant que <mark class="code">Ismael</mark> et vérifier que la connexion se passe bien.</li>
                    <li>Il est temps d'ajouter un secret. En tant que <mark class="code">Ismael</mark>, utiliser la méthode <mark class="code">POST</mark>, l'url <mark class="code">localhost:3000/secret</mark> et le <mark class="code">Body</mark> <mark class="code">{"secret":"Je suis amoureux."}</mark> pour poster ce secret.</li>
                    <li>Vérifier que l'on peut relire ce secret en utilisant la méthode <mark class="code">GET</mark> et l'url <mark class="code">localhost:3000/secret/0</mark>.</li>
                    <li>Créer un nouvel utilisateur.</li>
                    <li>Vérifier que ce nouvel utilisateur ne peux pas lire le secret 0.</li>
                    <li>Vérifier que, en étant connecté en tant que Ismael, on peut supprimer le secret 0 grâce à la méthode <mark class="code">DELETE</mark> et l'url <mark class="code">localhost:3000/secret/0</mark>.</li>
                </ol>
            </div>
        </div>
        <script type="text/javascript" src="../script.js"></script>
    </body>
</html>
